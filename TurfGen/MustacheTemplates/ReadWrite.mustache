// Autogenerated by TurfGen {{version}}
// ANY CHANGES WILL BE AUTOMATICALLY OVERWRITTEN
import Turf

{{accessibility}}protocol {{collectionsContainerProtocolName}} { }
extension {{containerTypeName}}: {{collectionsContainerProtocolName}} { }

{{accessibility}}class {{readWriteContainerTypeName}} {
{{# collections }}
    {{accessibility}}lazy var {{name}}: ReadWriteCollection<{{typeName}}> = {
            [unowned self] in
            return ReadWriteCollection(collection: self.collections.{{name}}, transaction: self.transaction)
        }()
{{/ collections }}

    {{accessibility}}let transaction: ReadWriteTransaction

    // MARK: Private properties

    private let collections: {{containerTypeName}}

    // MARK: Object lifecycle

    {{accessibility}}init(transaction: ReadWriteTransaction, collections: {{collectionsContainerProtocolName}}) {
        self.transaction = transaction
        self.collections = collections as! {{containerTypeName}}
    }
}

extension Connection where DatabaseCollections: {{collectionsContainerProtocolName}} {
    func readWrite(closure: ({{readWriteContainerTypeName}}) -> Void) {
        readWriteTransaction { (transaction) in
            let readWriteCollections = {{readWriteContainerTypeName}}(transaction: transaction, collections: self.collections)
            closure(readWriteCollections)
        }
    }
}
